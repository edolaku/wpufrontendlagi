alternatif dari chat gpt

loginService file useLogin.ts:
const loginService = async (payload: ILogin) => {
        try {
            console.log("ğŸ‘‰ loginService dipanggil:", payload);

            const result = await signIn("credentials", {
                ...payload,
                redirect: false,
                callbackUrl,
            });

            console.log("ğŸ‘‰ [useLogin] result:", result);
            return result;
        } catch (err) {
            console.error("âŒ Error dari signIn:", err);
            throw err;
        }
    };



authorize pada [...nextauth].ts:
async authorize(
                credentials: Record<"identifier" | "password", string> | undefined
            ): Promise<UserExtended | null> {
                try {
                    const { identifier, password } = credentials as { identifier: string, password: string };
                    const result = await authServices.login({ identifier, password });

                    console.log("ğŸ‘‰ [authorize nextauth.ts] result:", result);

                    const accessToken = result.data.data;
                    const me = await authServices.getProfileWithToken(accessToken);
                    const user = me.data.data;

                    if (accessToken && user) {
                        user.accessToken = accessToken;
                        return user;
                    }

                    return null;
                } catch (error: any) {
                    // kalau axios error, response ada di sini
                    if (error.response) {
                        console.error("âŒ Backend error:", error.response.data); // <-- message "User not found" keliatan
                        throw new Error(error.response.data.message); // <-- kirim ke frontend
                    }
                    throw new Error("Login failed");
                }
            }